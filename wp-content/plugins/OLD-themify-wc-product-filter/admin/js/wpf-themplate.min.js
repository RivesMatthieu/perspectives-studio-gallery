var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(b,h,f){b instanceof String&&(b=String(b));for(var k=b.length,a=0;a<k;a++){var d=b[a];if(h.call(f,d,a,b))return{i:a,v:d}}return{i:-1,v:void 0}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(b,h,f){b!=Array.prototype&&b!=Object.prototype&&(b[h]=f.value)};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};
$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(b,h,f,k){if(h){f=$jscomp.global;b=b.split(".");for(k=0;k<b.length-1;k++){var a=b[k];a in f||(f[a]={});f=f[a]}b=b[b.length-1];k=f[b];h=h(k);h!=k&&null!=h&&$jscomp.defineProperty(f,b,{configurable:!0,writable:!0,value:h})}};$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(b,f){return $jscomp.findInternal(this,b,f).v}},"es6-impl","es3");var WPF;
(function(b,h,f,k){WPF={prefix:"wpf_",template_type:!1,init:function(a){a=b.extend({prefix:this.prefix,template_type:this.template_type},a);this.prefix=a.prefix;this.template_type=a.template_type;this.Undelegate();this.bindEvents()},Undelegate:function(){b(f).off("change click")},bindEvents:function(){this.SetupColors();this.InitDraggable();this.InitSortable();this.ShowHide();this.Unique(b("#"+this.prefix+"module_content ."+this.prefix+"back_active_module_content"));this.Open();this.Delete();this.Save();
this.ShowThemplates();this.AddItem();this.RemmoveItem();this.multiLanguages();b.event.trigger("WPF.template_load",this.template_type)},PlaceHoldDragger:function(){b("."+WPF.prefix+"module_holder").each(function(){var a=b(this).find("."+WPF.prefix+"empty_holder_text");0===b(this).find("."+WPF.prefix+"active_module").length?a.show():a.hide()})},InitDraggable:function(){var a=this;b("."+a.prefix+"back_module_panel ."+a.prefix+"back_module").draggable({appendTo:"body",helper:"clone",revert:"invalid",
snapMode:"inner",connectToSortable:"."+a.prefix+"module_holder",stop:function(d,c){var e=b(c.helper[0]),g=e.data("type");0<b("#"+a.prefix+"module_content").find('[data-type="'+g+'"]').length&&(b("#"+a.prefix+"cmb_"+g).hide(),b.event.trigger("WPF.template_drag_start",[e,c,a.template_type]),a.Unique(e),g=e.find("."+a.prefix+"color_picker"),a.DestroyInputColor(g),a.SetInputColor(g),e.find("."+a.prefix+"toggle_module").trigger("click"),b.event.trigger("WPF.template_drag_end",[e,c,a.template_type]))}})},
InitSortable:function(){var a=this;b("."+a.prefix+"module_holder").sortable({placeholder:a.prefix+"ui_state_highlight",items:"."+a.prefix+"back_module",connectWith:"."+a.prefix+"module_holder",cursor:"move",revert:100,axis:"y",cancel:".wpf_active_module",sort:function(d,c){var e=c.item.outerHeight();b("."+a.prefix+"module_holder ."+a.prefix+"ui_state_highlight").height(e)},receive:function(d,c){a.PlaceHoldDragger();b(this).parent().find("."+a.prefix+"empty_holder_text").hide();b(c.item).removeClass("dragged")},
start:function(d,c){b(c.item).removeClass(a.prefix+"dragged")},stop:function(d,c){b(c.item).addClass(a.prefix+"dragged")}});b("."+a.prefix+"back_active_module_add").sortable({placeholder:a.prefix+"ui_state_highlight",items:"li",connectWith:"parent",cursor:"move",revert:100,axis:"y"})},ShowHide:function(){b("#"+WPF.prefix+"lightbox_container").on("change","."+WPF.prefix+"changed input,."+WPF.prefix+"changed select",function(){var a=!0;if(b(this).closest("."+WPF.prefix+"show_icons").length&&!b(this).closest("."+
WPF.prefix+"items_container").length){var d=b(this).closest("."+WPF.prefix+"show_icons").find("."+WPF.prefix+"items_container");a=b(this).is(":checked")}else if(0<b(this).closest("."+WPF.prefix+"result_page_wrapper").length&&("wpf_diff_page"==this.id||"wpf_same_page"==this.id))d=b(this).closest("."+WPF.prefix+"result_page_wrapper").find("."+WPF.prefix+"result_page_select"),a="diff_page"===b(this).val();else if(0<b(this).closest("."+WPF.prefix+"grid").length)d=b("#"+WPF.prefix+"group_fields").closest("."+
WPF.prefix+"lightbox_row"),a="vertical"===b(this).val();else if(0<b(this).closest("."+WPF.prefix+"order").length)d=b(this).closest("."+WPF.prefix+"order").next("."+WPF.prefix+"orderby"),a="term_order"!==b(this).val();else if(0<b(this).closest("."+WPF.prefix+"show_range").length){var c=b(this).closest("."+WPF.prefix+"back_active_module_row"),e=c.next("."+WPF.prefix+"group"),c=c.nextAll("."+WPF.prefix+"slider");"group"===b(this).val()?(c.slideUp(),e.slideDown()):(e.slideUp(),c.slideDown())}else 0<b(this).closest("."+
WPF.prefix+"display_as").length?(d=b(this).closest("."+WPF.prefix+"back_active_module_content").find("."+WPF.prefix+"icons_block"),e=b(this).val(),a="checkbox"===e||"radio"===e,"dropdown"===e||"radio"===e?b(this).closest("."+WPF.prefix+"back_active_module_content").find("."+WPF.prefix+"show_all_block").show():b(this).closest("."+WPF.prefix+"back_active_module_content").find("."+WPF.prefix+"show_all_block").hide()):"wpf_pagination_fields"===b(this).prop("id")&&(d=b(".wpf_infinity"),a=!b(this).is(":checked"));
"undefined"!==typeof d&&(a?d.slideDown():d.slideUp())});b("."+WPF.prefix+"changed input:checked,."+WPF.prefix+"changed option:selected").trigger("change")},Open:function(){var a=this;b(f).on("click","."+a.prefix+"toggle_module",function(d){var c=b(this).closest("."+a.prefix+"back_module").find("."+a.prefix+"back_active_module_content");b(this).hasClass(a.prefix+"opened")||c.is(":visible")?(b(this).removeClass(a.prefix+"opened"),c.slideUp()):(b(this).addClass(a.prefix+"opened"),c.slideDown());d.preventDefault()})},
Delete:function(){b(f).on("click","."+WPF.prefix+"delete_module",function(a){a.preventDefault();confirm(wpf_js.module_delete)&&(a=b(this).closest("."+WPF.prefix+"back_module"),b("#"+WPF.prefix+"cmb_"+a.data("type")).show(),a.remove(),WPF.PlaceHoldDragger())})},Save:function(){var a=this;b("#"+a.prefix+"submit").click(function(d){var c=b(this).closest("form"),e=b("."+a.prefix+"back_builder").find("input,select,textarea");e.prop("disabled",!0);setTimeout(function(){var d=a.ParseData();b.event.trigger("WPF.before_template_save",
d);d=JSON.stringify(d);b("#"+a.prefix+"layout").val(d);b.ajax({url:c.prop("action"),method:"POST",dataType:"json",data:c.serialize(),beforeSend:function(){c.removeClass(a.prefix+"done").addClass(a.prefix+"save")},complete:function(){e.prop("disabled",!1);c.removeClass(a.prefix+"save").addClass(a.prefix+"done")},success:function(d){d&&"1"==d.status&&(c.find("#"+a.prefix+"themplate_id").val(d.id),b("#"+a.prefix+"success_text").html("<p><strong>"+d.text+"</strong></p>").show(),setTimeout(function(){b("#"+
a.prefix+"success_text").html("").hide()},2E3),b.event.trigger("WPF.after_template_save"))}})},100);d.preventDefault()})},ParseData:function(){var a={};b("#"+WPF.prefix+"module_content").find("."+WPF.prefix+"back_active_module_content").each(function(){var d=b(this).data("type");a[d]={};b(this).find('input:checked,input[type="text"],input[type="number"],input[type="hidden"],textarea,select').each(function(){var c=b(this).attr("name");if(c){var e=c.split("]");if(e){e.pop();var c=[],g;for(g in e){var f=
e[g].split("[");f[1]&&(c[g]=f[1])}(g="arr"==c[2])||a[d][c[1]]&&!c[2]?g?(a[d][c[1]]=b(this).val(),a[d][c[1]]||(a[d][c[1]]=[])):("object"!=typeof a[d][c[0]]&&"object"!=typeof a[d][c[1]]&&(g=a[d][c[1]],a[d][c[1]]=[],a[d][c[1]][0]=g),a[d][c[1]].push(b(this).val())):c[2]?(g=c[2],"object"!=typeof a[d][c[1]]&&(a[d][c[1]]={}),a[d][c[1]][g]=b(this).val()):(b(this).hasClass(WPF.prefix+"color_picker")?(g=b(this).minicolors("rgbaString"),g="rgba(0, 0, 0, 1)"!=g||b(this).val()?g:!1):g="on"==b(this).val()?!0:b(this).val(),
a[d][c[1]]=g)}}})});return a},Unique:function(a){a.each(function(){var a=b(this);a.find("label").each(function(){var d=b(this).attr("for");if(d&&(d=WPF.Escape(b(this).attr("for")),0<b("#"+d).length)){var c=WPF.GenerateUnique();a.find("#"+d).attr("id",c);b(this).attr("for",c)}});var c=/.*?\[(.+?)\]/ig,e={};a.find('input[type="radio"]').each(function(a){(a=b(this).attr("name"))&&(e[a]=1)});for(var g in e){var f=g.match(c);if(f){var h=WPF.GenerateUnique(),k=a.find('input:radio[name="'+g+'"]'),f=h+f[0]+
f[1];k.attr("name",f);a.find('input:radio[name!="'+g+'"]')&&a.find('input:radio[name="'+f+'"][checked]').prop("checked",!0)}}})},GenerateUnique:function(){return WPF.prefix+Math.random().toString(36).substr(2,9)},Escape:function(a){return a.replace(/(:|\.|\[|\]|,)/g,"\\$1")},SetupColors:function(){b("#"+WPF.prefix+"module_content").find("."+WPF.prefix+"color_picker").each(function(){var a=WPF.RgbaToHex(b(this).data("value"));a&&-1!==a.indexOf("@")&&(a=a.split("@"),b(this).val(a[0]),b(this).attr("data-opacity",
a[1]))});this.SetInputColor()},SetInputColor:function(a){a||(a=b("."+WPF.prefix+"color_picker"));a.minicolors({opacity:!0,position:"top right",theme:"default",show:function(){b("."+WPF.prefix+"module_holder").sortable("disable")},hide:function(){b("."+WPF.prefix+"module_holder").sortable("enable")},create:function(a){}})},DestroyInputColor:function(a){a||(a=b("#"+WPF.prefix+"module_content").find("."+WPF.prefix+"color_picker"));a.minicolors("destroy")},RgbaToHex:function(a){if(!a)return!1;var b=(a=
a.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(.*)[\s+]?\)/i))&&3<=a.length?"#"+("0"+parseInt(a[1],10).toString(16)).slice(-2)+("0"+parseInt(a[2],10).toString(16)).slice(-2)+("0"+parseInt(a[3],10).toString(16)).slice(-2):"";b&&a[4]&&(b+="@"+a[4]);return b},ShowThemplates:function(){var a=this.prefix;b(f).on("WPF.close_lightbox",function(d,c){if(b(c).closest(".wpf_admin_lightbox").find("#"+a+"themplate_id").val()){var e=b("#the-list");b.ajax({url:ajaxurl,type:"POST",
data:{action:"wpf_get_list"},beforeSend:function(){e.addClass(a+"wait")},complete:function(){e.removeClass(a+"wait")},success:function(a){a&&e.replaceWith(b(a).find("#the-list"))}})}})},AddItem:function(){b("#"+WPF.prefix+"module_content").delegate("."+WPF.prefix+"add_item","click",function(a){a.preventDefault();a=b(this).prev("ul").children("li").first().clone();a.hide().find("input").val("");b(this).prev("ul").append(a);a.slideDown()})},RemmoveItem:function(){b("#"+WPF.prefix+"module_content").delegate("."+
WPF.prefix+"remove_item","click",function(a){a.preventDefault();b(this).closest("li").slideUp(function(){b(this).remove()})})},multiLanguages:function(){b("body").on("click",".wpf_language_tabs li",function(a){a.preventDefault();a=b(this);if(!a.hasClass("wpf_active_tab_lng")){a.siblings(".wpf_active_tab_lng").removeClass("wpf_active_tab_lng");a.addClass("wpf_active_tab_lng");var d=a.parents(".wpf_language_tabs").parent().find(".wpf_language_fields");d.find("li").removeClass("wpf_active_lng");d.find('li[data-lng="'+
a.children("a").attr("class")+'"]').addClass("wpf_active_lng")}})}}})(jQuery,window,document);
